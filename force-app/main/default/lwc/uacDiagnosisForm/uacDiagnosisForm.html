<!--
  @File Name         : uacDiagnosisForm.html
  @Description       : Create/Edit form for Diagnosis object
  @Group             : uacForm
  @Author            : Sachet Khanal (Deloitte)
  @Last Modified By  : Sachet Khanal (Deloitte)
  @Last Modified On  : 11-17-2020
  Modifications Log
  Ver   Date         Author                     Modification
  1.0   08-07-2020   Sachet Khanal (Deloitte)   Initial Version
-->
<template>

  <template if:true={isLoading}>
    <lightning-spinner alternative-text="Loading"></lightning-spinner>
  </template>


  <c-uac-modal class="uac-modal" header={title} size="medium" onclosedialog={handleClose}>

    <template if:true={initialized}>
      <template if:true={error}>
        <div class="slds-notify_container slds-is-relative">
          <div class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_error" role="alert">
            <div class="slds-notify__content">
              <h2 class="slds-text-heading_small">{saveErrorTitle}</h2>
              <lightning-formatted-rich-text value={error}>
              </lightning-formatted-rich-text>
            </div>
          </div>
        </div>
      </template>

      <template if:true={showStatusField}>
        <div class="slds-grid slds-gutters">
          <div class="slds-col slds-size_1-of-2">
            <c-uac-input
              type="picklist"
              label={diagnosisStatusLabel}
              options={diagnosisStatusOptions}
              value={diagnosisStatus}
              required
              onfieldchange={handleStatusChange}>
            </c-uac-input>
          </div>
          <div class="slds-col"></div>
        </div>
      </template>

      <template if:false={isReplacement}>
        <c-uac-record-edit-form record-id={recordId}
          record-type={diagnosisRecordType}
          object-api-name={objectApiName}
          onloadcomplete={handleLoadComplete}
          onfieldchange={handleFieldChange}
          onerror={handleError}
          onsubmit={handleSubmit}>

          <div slot="form-top">
            <lightning-input-field field-name={fldDiagnosisAssociatedUAC} value={associatedUACId} class="slds-hide">
            </lightning-input-field>
            <lightning-input-field field-name={fldDiagnosisAssociatedHealthEval} value={associatedHealthEvaluationId} class="slds-hide">
            </lightning-input-field>
            <lightning-input-field field-name={fldDiagnosisParentDiagnosis} value={parentDiagnosisId} class="slds-hide">
            </lightning-input-field>
          </div>

        </c-uac-record-edit-form>
      </template>

      <template if:true={isReplacement}>
        <c-uac-flow-header title="Replacement Diagnosis">
        </c-uac-flow-header>

        <c-uac-record-edit-form
          object-api-name={objectApiName}
          record-type={diagnosisRecordType}
          onloadcomplete={handleLoadComplete}
          onfieldchange={handleFieldChange}
          onerror={handleError}
          onsubmit={handleSubmit}>

          <div slot="form-top">
            <lightning-input-field field-name={fldDiagnosisAssociatedUAC} value={associatedUACId} class="slds-hide">
            </lightning-input-field>
            <lightning-input-field field-name={fldDiagnosisAssociatedHealthEval} value={associatedHealthEvaluationId} class="slds-hide">
            </lightning-input-field>
            <lightning-input-field field-name={fldDiagnosisParentDiagnosis} value={recordId} class="slds-hide">
            </lightning-input-field>
          </div>

        </c-uac-record-edit-form>
      </template>

      <br/><br/><br/><br/><br/><br/><br/>

      <div slot="footer">
        <button class="slds-button slds-button_neutral" onclick={handleClose}>Cancel</button>
        <button class="slds-button slds-button_brand" onclick={handleSave}>Save</button>
      </div>
    </template>
  </c-uac-modal>
</template>